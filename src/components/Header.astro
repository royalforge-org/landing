---
import { Image } from 'astro:assets';
import Logo from '../../public/royalforge-logo.png';

interface Props {
  showBackButton?: boolean;
}

const { showBackButton = false } = Astro.props;
---

<header>
  <div class="header-content">
     <div class="header-logo">
        <Image 
          src={Logo} 
          alt="RoyalForge" 
          width={55}
          height={45}
          quality={70}
          loading="eager"
          aria-label={"Royal Forge"}
        />
      </div>

      
    <div class="header-actions">
      <!-- desktop nav -->
      <nav class="desktop-nav" aria-label="Primary">
        <a href="/#features">Features</a>
        <a href="/lightpaper">About us</a>
        <a href="/#join">Join</a>
        {showBackButton && (
        <a href="/" aria-label="Back to Home">

          <span>Home</span>
        </a>
      )}
        <a href="/register" class="nav-cta">Connect with us</a>
        
        
        <!-- Social dropdown in header -->
        <div class="header-social-dropdown">
          <button class="social-dropdown-btn" aria-label="Social Media" aria-expanded="false">
            Social Networks
            <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="dropdown-arrow">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div class="social-dropdown-menu" hidden>
            <a href="https://www.facebook.com/profile.php?id=61582604207021" target="_blank" rel="noopener noreferrer" aria-label="Facebook" class="social-link">
              <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
              <span class="sr-only">Facebook</span>
            </a>
            <a href="https://www.instagram.com/royal_forge_official/" target="_blank" rel="noopener noreferrer" aria-label="Instagram" class="social-link">
              <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
              <span class="sr-only">Instagram</span>
            </a>
            <a href="https://x.com/RoyalForge_cu" target="_blank" rel="noopener noreferrer" aria-label="Twitter/X" class="social-link">
              <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
              <span class="sr-only">Twitter/X</span>
            </a>
            <a href="https://www.linkedin.com/company/royal-forge/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="social-link">
              <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              <span class="sr-only">LinkedIn</span>
            </a>
          </div>
        </div>
      </nav>

      <a
        href="https://t.me/royalforge"
        target="_blank"
        rel="noopener noreferrer"
        class="header-telegram-link"
        aria-label="Join RoyalForge on Telegram"
      >
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18 1.897-.962 6.502-1.359 8.627-.168.9-.5 1.201-.82 1.23-.697.064-1.226-.461-1.901-.903-1.056-.693-1.653-1.124-2.678-1.8-1.185-.781-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.139-5.062 3.345-.479.329-.913.489-1.302.481-.428-.008-1.252-.241-1.865-.44-.752-.244-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.831-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635.099-.002.321.023.465.14.121.099.155.232.171.326.016.094.036.308.02.474z"/>
        </svg>
        <span class="sr-only">Telegram</span>
      </a>

      <!-- mobile menu button -->
      <button class="mobile-menu-btn" aria-label="Open menu" aria-expanded="false" type="button">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>

  <!-- mobile nav sliding panel -->
  <nav class="mobile-nav" aria-label="Mobile" hidden style="display: none;">
    <a href="/#features">Features</a>
    <a href="/lightpaper">About us</a>
    <a href="/#join">Join</a>
    <a href="/register" class="nav-cta">Contact with us</a>
    
    <!-- Social icons in mobile menu -->
    <div class="mobile-nav-social">
      <a href="https://www.facebook.com/profile.php?id=61582604207021" target="_blank" rel="noopener noreferrer" aria-label="Facebook" class="social-link">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
          <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
        </svg>
      </a>
      <a href="https://www.instagram.com/royal_forge_official/" target="_blank" rel="noopener noreferrer" aria-label="Instagram" class="social-link">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
        </svg>
      </a>
      <a href="https://x.com/RoyalForge_cu" target="_blank" rel="noopener noreferrer" aria-label="Twitter/X" class="social-link">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
          <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
        </svg>
      </a>
      <a href="https://www.linkedin.com/company/royal-forge/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="social-link">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
        </svg>
      </a>
    </div>
  </nav>
</header>

<script>
  (function () {
    const btn = document.querySelector('.mobile-menu-btn') as HTMLButtonElement | null;
    const mobileNav = document.querySelector('.mobile-nav') as HTMLElement | null;
    const root = document.documentElement;

    if (!btn || !mobileNav) return;

    function measureMenuHeight() {
      if (!mobileNav) return;
      const wasHidden = mobileNav.hasAttribute('hidden') && mobileNav.style.display === '';
      const prevDisplay = mobileNav.style.display;
      mobileNav.style.display = 'flex';
      const h = Math.ceil(mobileNav.getBoundingClientRect().height);
      mobileNav.style.display = prevDisplay || (wasHidden ? 'none' : 'flex');
      root.style.setProperty('--mobile-menu-height', `${h}px`);
    }

    function openMenu() {
      if (!mobileNav || !btn) return;
      mobileNav.setAttribute('data-open', 'true');
      mobileNav.removeAttribute('hidden');
      mobileNav.style.display = 'flex';
      btn.classList.add('active');
      btn.setAttribute('aria-expanded', 'true');
      setTimeout(measureMenuHeight, 0);
      document.body.classList.add('mobile-nav-open');
    }

    function closeMenu() {
      if (!mobileNav || !btn) return;
      mobileNav.removeAttribute('data-open');
      mobileNav.setAttribute('hidden', '');
      mobileNav.style.display = 'none';
      btn.classList.remove('active');
      btn.setAttribute('aria-expanded', 'false');
      root.style.setProperty('--mobile-menu-height', '0px');
      document.body.classList.remove('mobile-nav-open');
    }

    btn.addEventListener('click', () => {
      if (!mobileNav) return;
      const isOpen = mobileNav.hasAttribute('data-open');
      if (isOpen) closeMenu();
      else openMenu();
    });

    document.addEventListener('click', (ev) => {
      if (!mobileNav || !btn) return;
      if (!mobileNav.hasAttribute('data-open')) return;
      const target = ev.target as Node;
      if (!mobileNav.contains(target) && !btn.contains(target)) {
        closeMenu();
      }
    });

    window.addEventListener('resize', () => {
      if (!mobileNav) return;
      if (mobileNav.hasAttribute('data-open')) {
        measureMenuHeight();
      }
    });
  })();

  // Social dropdown functionality
  (function () {
    const dropdownBtn = document.querySelector('.social-dropdown-btn');
    const dropdownMenu = document.querySelector('.social-dropdown-menu');

    if (!dropdownBtn || !dropdownMenu) return;

    function openDropdown() {
      if (!dropdownMenu || !dropdownBtn) return;
      dropdownMenu.removeAttribute('hidden');
      dropdownBtn.setAttribute('aria-expanded', 'true');
    }

    function closeDropdown() {
      if (!dropdownMenu || !dropdownBtn) return;
      dropdownMenu.setAttribute('hidden', '');
      dropdownBtn.setAttribute('aria-expanded', 'false');
    }

    dropdownBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      const isOpen = dropdownBtn.getAttribute('aria-expanded') === 'true';
      if (isOpen) closeDropdown();
      else openDropdown();
    });

    document.addEventListener('click', (e) => {
      if (!dropdownBtn || !dropdownMenu) return;
      const target = e.target as Node;
      if (!dropdownBtn.contains(target) && !dropdownMenu.contains(target)) {
        closeDropdown();
      }
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeDropdown();
      }
    });
  })();
</script>

<style>
  :root {
    --royal-blue: #002A8F;
    --royal-red: #CF142B;
    --text-primary: #0f1724;
    --text-secondary: #475569;
    --header-height: 64px;
    --mobile-menu-height: 0px;
  }

  header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--header-height);
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    padding: 0;
    z-index: 1000;
  }

  .header-content {
    max-width: 1800px;
    margin: 0 auto;
    padding: 0 2rem;
    height: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .header-logo {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 1.25rem;
  }

  .desktop-nav {
    display: flex;
    gap: 2rem;
    align-items: center;
  }

  .desktop-nav a {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    transition: color 0.3s;
  }

  .desktop-nav a:hover {
    color: var(--royal-blue);
  }

  .nav-cta {
    background: var(--royal-blue);
    color: white !important;
    padding: 0.6rem 1.5rem;
    border-radius: 8px;
    transition: all 0.3s;
  }

  .nav-cta:hover {
    background: var(--royal-red);
    transform: translateY(-2px);
  }

  .header-telegram-link {
    display: inline-flex;
    align-items: center;
    gap: 0.55rem;
    background: linear-gradient(135deg, var(--royal-blue), var(--royal-red));
    color: white;
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 600;
    padding: 0.55rem 1.2rem;
    border-radius: 999px;
    box-shadow: 0 10px 24px rgba(0, 42, 143, 0.18);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
    

  .header-telegram-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 28px rgba(207, 20, 43, 0.25);
  }

  .header-social-dropdown {
    position: relative;
    margin-left: 1rem;
    padding-left: 1rem;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
  }

  .social-dropdown-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(0, 42, 143, 0.05);
    color: var(--royal-blue);
    border: 1px solid rgba(0, 42, 143, 0.1);
    padding: 0.6rem 1rem;
    border-radius: 8px;
    font-size: 0.875rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
  }

  .social-dropdown-btn:hover {
    background: rgba(0, 42, 143, 0.1);
    border-color: var(--royal-blue);
  }

  .social-dropdown-btn[aria-expanded="true"] .dropdown-arrow {
    transform: rotate(180deg);
  }

  .dropdown-arrow {
    transition: transform 0.3s;
  }

  .social-dropdown-menu {
    position: absolute;
    top: calc(100% + 0.5rem);
    right: 0;
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    padding: 0.5rem;
    min-width: 200px;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .social-dropdown-menu:not([hidden]) {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .social-dropdown-menu a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    color: var(--text-secondary);
    text-decoration: none;
    border-radius: 8px;
    font-size: 0.95rem;
    font-weight: 500;
    transition: all 0.2s;
  }

  .social-dropdown-menu a:hover {
    background: rgba(0, 42, 143, 0.05);
    color: var(--royal-blue);
  }

  .mobile-menu-btn {
    display: none;
    flex-direction: column;
    gap: 5px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    margin-left: 0.5rem;
  }

  .mobile-menu-btn span {
    width: 25px;
    height: 3px;
    background: var(--royal-blue);
    border-radius: 3px;
    transition: all 0.3s;
    display: block;
  }

  .mobile-menu-btn.active span:nth-child(1) {
    transform: rotate(45deg) translateY(8px);
  }

  .mobile-menu-btn.active span:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-btn.active span:nth-child(3) {
    transform: rotate(-45deg) translateY(-8px);
  }

  .mobile-nav {
    display: none;
    flex-direction: column;
    gap: 0.5rem;
    position: fixed;
    top: var(--header-height);
    left: 0;
    right: 0;
    background: white;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    padding: 1rem 1.5rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
    z-index: 999;
    max-height: calc(100vh - var(--header-height));
    overflow-y: auto;
  }

  .mobile-nav[data-open] {
    display: flex;
  }

  .mobile-nav a {
    color: var(--text-secondary);
    text-decoration: none;
    font-size: 1rem;
    font-weight: 600;
    padding: 0.6rem 0.5rem;
    border-radius: 8px;
  }

  .mobile-nav a:hover {
    background: rgba(0, 42, 143, 0.04);
    color: var(--royal-blue);
  }

  .mobile-nav-social {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(0, 0, 0, 0.06);
  }

  .mobile-nav-social a {
    width: 44px;
    height: 44px;
    border-radius: 8px;
    background: rgba(0, 42, 143, 0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--royal-blue);
    transition: all 0.3s;
    padding: 0;
  }

  .mobile-nav-social a:hover {
    background: var(--royal-blue);
    color: white;
    transform: translateY(-2px);
  }

  .sr-only {
    font-size: 0.9rem;
  font-weight: 500;
  margin-left: 0.5rem;
  }

  @media (max-width: 768px) {
    .desktop-nav {
      display: none;
    }

    .mobile-menu-btn {
      display: flex;
    }

    .header-actions {
      gap: 0.75rem;
    }

    .header-content {
      padding: 0 1.5rem;
    }

    .header-social-dropdown {
      display: none;
    }

    .mobile-nav[hidden] {
      display: none !important;
    }

    :root {
      --header-height: 56px;
    }

    .header-telegram-link {
      padding: 0.45rem 0.6rem;
      border-radius: 12px;
      box-shadow: none;
    }

    .header-telegram-link span {
      display: none;
    }

    .header-telegram-link svg {
      width: 22px;
      height: 22px;
    }
  }

  a:focus-visible,
button:focus-visible {
  outline: 3px solid #ffbf47;
  outline-offset: 3px;
  box-shadow: 0 0 0 3px rgba(255, 191, 71, 0.12);
}


a:focus,
button:focus {
  outline: none;
  box-shadow: none;
}

